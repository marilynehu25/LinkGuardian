{% extends "_layout/base.html" %}
{% block title %}Inscription pour un nouveau utilisateur{% endblock %}

{% block content %}
<div class="flex justify-center items-center min-h-screen bg-gradient-to-b from-slate-800 to-slate-900">
  <div class="bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl p-10 w-full max-w-md text-center border border-white/20">
    <h1 class="text-3xl font-bold text-white mb-6">Inscription pour un nouveau utilisateur</h1>

    <form method="POST" action="/signup" class="space-y-6">

      <input
        name="first_name"
        type="text"
        placeholder="PrÃ©nom"
        class="w-full px-4 py-3 text-lg bg-white/90 text-black rounded-xl border border-gray-300 focus:border-blue-400 focus:ring-2 focus:ring-blue-300 focus:outline-none transition"
        required
      >

      <input
        name="last_name"
        type="text"
        placeholder="Nom"
        class="w-full px-4 py-3 text-lg bg-white/90 text-black rounded-xl border border-gray-300 focus:border-blue-400 focus:ring-2 focus:ring-blue-300 focus:outline-none transition"
        required
      >

      <input
        name="email"
        type="email"
        placeholder="Email (celui utilisÃ© pour se connecter)"
        class="w-full px-4 py-3 text-lg bg-white/90 text-black rounded-xl border border-gray-300 focus:border-blue-400 focus:ring-2 focus:ring-blue-300 focus:outline-none transition"
        required
      >

      <!-- Mot de passe avec bouton Å“il -->
      <div x-data="{
              password: '',
              valid: false
          }"
          x-init="
              $watch('password', value => {
                  const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
                  valid = regex.test(value);
              });
          "
          class="space-y-4"
      >

          <!-- Consignes (au-dessus du champ + bel espacement) -->
          <p class="text-sm"
            :class="valid ? 'text-green-600' : 'text-red-600'">
              Le mot de passe doit contenir au moins 8 caractÃ¨res,  
              dont 1 majuscule, 1 minuscule, 1 chiffre et 1 symbole.
          </p>

          <!-- Champ mot de passe avec Å“il -->
          <div class="relative">
              <input 
                id="password"
                name="password" 
                :type="$refs.eyeBtn?.dataset.show === 'true' ? 'text' : 'password'"
                x-model="password"
                placeholder="Mot de passe" 
                class="w-full px-4 py-3 pr-12 text-lg bg-white/90 text-black rounded-xl border transition focus:outline-none
                      border-gray-300 focus:ring-2"
                :class="valid 
                    ? 'focus:ring-green-400 border-green-500' 
                    : 'focus:ring-red-400 border-red-500'"
                required
              >

              <!-- Bouton Å“il (tu gardes TON JS existant !) -->
              <button 
                  type="button"
                  x-ref="eyeBtn"
                  data-show="false"
                  onclick="togglePassword('password', this)"
                  class="absolute inset-y-0 right-4 flex items-center text-gray-600 hover:text-gray-800 focus:outline-none"
              >
                  ğŸ‘ï¸
              </button>
          </div>

      </div>

      <!-- Confirmation de mot de passe avec Å“il aussi -->
      <div class="relative">
        <input
          id="confirm_password"
          name="confirm_password"
          type="password"
          placeholder="Confirmer le mot de passe"
          class="w-full px-4 py-3 pr-12 text-lg bg-white/90 text-black rounded-xl border border-gray-300 focus:border-blue-400 focus:ring-2 focus:ring-blue-300 focus:outline-none transition"
          required
        >
        <button type="button" onclick="togglePassword('confirm_password', this)" 
                class="absolute inset-y-0 right-4 flex items-center text-gray-600 hover:text-gray-800 focus:outline-none">
          ğŸ‘ï¸
        </button>
      </div>

    <!-- Bouton S'inscrire -->
    <button 
      type="submit" 
      :disabled="!valid"
      class="w-full bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold py-3 rounded-xl 
            hover:scale-[1.02] hover:shadow-lg transition-transform duration-200
            disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100"
    >
      ğŸ‘¤â• S'inscrire
    </button>

    <div class="mt-6 text-gray-300 text-base">
      DÃ©jÃ  inscrit ?
      <a href="/login" class="text-blue-400 font-semibold hover:underline">
        Se connecter
      </a>
    </div>
  </div>
</div>

<!-- Script pour basculer lâ€™affichage du mot de passe -->
<script>
function togglePassword(id, button) {
  const input = document.getElementById(id);
  if (input.type === "password") {
    input.type = "text";
    button.textContent = "ğŸ™ˆ"; // change lâ€™icÃ´ne quand visible
  } else {
    input.type = "password";
    button.textContent = "ğŸ‘ï¸"; // remet lâ€™Å“il quand cachÃ©
  }
}
</script>
{% endblock %}
